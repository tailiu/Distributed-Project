// Generated by CoffeeScript 1.12.7
(function() {
  module.exports = function(authorize) {
    return function(req, callback) {
      var auth, parts, token, user;
      if (req.headers.authorization == null) {
        return false;
      }
      token = req.headers.authorization;
      parts = token.split(' ');
      if ('basic' !== parts[0].toLowerCase() || !parts[1]) {
        return false;
      }
      auth = new Buffer(parts[1], 'base64').toString();
      user = auth.split(':');
      if (user.length !== 2) {
        return false;
      }
      return authorize(user[0], user[1], callback);
    };
  };

}).call(this);
